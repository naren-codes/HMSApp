@model IEnumerable<HMSApp.Models.Appointment>

@{
    ViewData["Title"] = "Patient Dashboard";
    Layout = "_Layout";
}

<link href="~/css/patient-dashboard.css" rel="stylesheet" asp-append-version="true" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

<div class="container-fluid py-4">
    <div class="dd-header-bar mb-4">
        <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
            <div>
                <h2 class="fw-bold mb-1 text-light"><i class="bi bi-person-fill"></i> Patient Dashboard</h2>
                <div class="small opacity-75">Welcome, <span class="patient-name-inline">@ViewData["PatientName"]</span>.</div>
            </div>
            <div class="nav-quick">
                <a class="btn btn-sm btn-light px-3" asp-controller="Patient" asp-action="AppointmentHistory"><i class="bi bi-calendar-event me-1"></i>Appointments</a>
                <a class="btn btn-sm btn-light px-3" href="#"><i class="bi bi-capsule-pill me-1"></i>Prescriptions</a>
                <a class="btn btn-sm btn-light px-3" asp-controller="Patient" asp-action="Profile"><i class="bi bi-person-badge me-1"></i>Profile</a>
                
            </div>
        </div>
    </div>

    <div class="container main-content">
        <div class="row g-4 mb-5">
            <div class="col-md-6">
                <div class="stat-card p-3 dd-header-bar">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-calendar-plus-fill display-4 text-info mb-3"></i>
                        <h5 class="card-title fw-bold">Book an Appointment</h5>
                        <p class="card-text text-muted">
                            Schedule a new appointment with a doctor easily.
                        </p>
                        <a asp-controller="Patient" asp-action="BookAppointment" class="btn btn-info text-white mt-3">Book Now</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="stat-card p-3" style="background:var(--dd-green-grad)">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-clock-history display-4 text-success mb-3"></i>
                        <h5 class="card-title fw-bold">Appointment History</h5>
                        <p class="card-text text-muted">
                            View your past and upcoming appointments.
                        </p>
                        <a asp-controller="Patient" asp-action="AppointmentHistory" class="btn btn-info text-white mt-3">View History</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="card dd-panel shadow-sm">
                <div class="card-header bg-white fw-bold d-flex align-items-center" style="font-size: 1.1rem;">
                    <i class="bi bi-calendar-day me-2 fs-5 text-primary"></i>
                    Today's & Upcoming Appointments
                </div>
                <div class="card-body p-0">
                    @if (Model != null && Model.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col" class="ps-4">Date</th>
                                        <th scope="col">Doctor</th>
                                        <th scope="col">Time</th>
                                        <th scope="col">Symptoms</th>
                                        <th scope="col">Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var appt in Model)
                                    {
                                        <tr>
                                            <td class="ps-4">@appt.AppointmentDate.ToString("dd MMM, yyyy")</td>
                                            <td>Dr. @appt.DoctorName</td>
                                            <td>@appt.TimeSlot</td>
                                            <td>@(string.IsNullOrWhiteSpace(appt.PatientDescription) ? "N/A" : appt.PatientDescription)</td>
                                            <td>
                                                @if (appt.Status.ToLower() == "pending")
                                                {
                                                    <span class="badge bg-warning text-dark">@appt.Status</span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-success">@appt.Status</span>
                                                }
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="text-center p-5">
                            <i class="bi bi-info-circle fs-1 text-muted"></i>
                            <p class="mt-3 mb-0 text-muted">No upcoming appointments available.</p>
                        </div>
                    }
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="stat-card patient-card-profile p-3 h-100">
                <div class="d-flex flex-column align-items-center">
                    <i class="bi bi-person-circle text-white mb-2" style="font-size: 4rem;"></i>
                    <h5 class="text-white">@ViewData["PatientName"]</h5>
                    <p class="text-white-50">Registered Patient</p>
                    <div class="availability-badge available my-2">
                        <i class="bi bi-check-circle-fill me-1"></i>Available
                    </div>
                    <hr class="border-light w-100 my-2 opacity-25">
                    <p class="text-white-50 small mb-1"><i class="bi bi-telephone-fill me-1"></i>Contact: --</p>
                    <p class="text-white-50 small"><i class="bi bi-calendar-event-fill me-1"></i>Schedule: --</p>
                    <a asp-controller="Patient" asp-action="Profile" class="stretched-link"></a>
                </div>
            </div>
        </div>
    </div>
</div>