@model HMSApp.Controllers.PatientController.BillDisplayViewModel
@{
    ViewData["Title"] = "Bill Receipt";
    Layout = "_Layout";
    bool isDoctorMode = ViewData["DoctorMode"] as bool? ?? false;
}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />
<link rel="stylesheet" href="~/css/bill.css" asp-append-version="true" />

<div class="container py-4">
  <div class="bill-wrapper mx-auto">
    <div class="bill-header text-center mb-4">
      <h2 class="fw-bold"><i class="bi bi-receipt me-2"></i>Payment Receipt</h2>
      <div class="small text-muted">Bill ID: #@Model.Bill.BillId • Date: @Model.Bill.BillDate.ToString("dd MMM yyyy")</div>
    </div>
    
    <div class="section">
      <h5>Patient Details</h5>
      <div class="row g-3">
        <div class="col-md-6 small">
          <strong>Name:</strong> @Model.Patient.Name<br />
          <strong>Gender:</strong> @Model.Patient.Gender<br />
          <strong>DOB:</strong> @Model.Patient.DateOfBirth.ToString("dd MMM yyyy")<br />
        </div>
        <div class="col-md-6 small">
          <strong>Contact:</strong> @(Model.Patient.ContactNumber ?? "-")<br />
          <strong>Address:</strong> @(Model.Patient.Address ?? "-")<br />
        </div>
      </div>
    </div>
    
    <div class="section">
      <h5>Bill Summary</h5>
      <table class="table-summary">
        <thead>
          <tr>
            <th>Description</th>
            <th style="width:140px;text-align:right">Amount (Rs.)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Consultation / Treatment Charges</td>
            <td style="text-align:right">@Model.Bill.TotalAmount.ToString("0.00")</td>
          </tr>
        </tbody>
      </table>
      <div class="total-box">
        <div><strong>Total:</strong> Rs. @Model.Bill.TotalAmount.ToString("0.00")</div>
        <div><strong>Payment Method:</strong> @(Model.Bill.PaymentMethod ?? "Unknown")</div>
        <div><strong>Payment Status:</strong> <span class="badge-status @(Model.Bill.PaymentStatus=="Paid"?"badge-paid":"badge-unpaid")">@Model.Bill.PaymentStatus</span></div>
      </div>
    </div>
    
    <div class="section">
      <h5>Prescription / Notes</h5>
      @{
          var displayPrescription = Model.Bill.Prescription ?? "";
          // Remove payment method tags from display
          displayPrescription = displayPrescription.Replace("[PAYMENT: Cash]", "").Replace("[PAYMENT: UPI]", "").Replace("[PAYMENT: GPay]", "").Trim();
      }
      <div class="prescription-box">@(string.IsNullOrWhiteSpace(displayPrescription) ? "No prescription provided." : displayPrescription)</div>
    </div>
    
    <div class="section small text-muted">
      This is a computer generated receipt for your records.
    </div>
    
    <div class="actions">
      @if (isDoctorMode)
      {
        <a asp-controller="Doctor" asp-action="DoctorDashboard" class="btn btn-primary"><i class="bi bi-speedometer2"></i> Doctor Dashboard</a>
      }
      else
      {
        <a asp-controller="Patient" asp-action="Dashboard" class="btn btn-primary"><i class="bi bi-speedometer2"></i> Patient Dashboard</a>
      }
    </div>
  </div>
</div>